<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<title>
Zequez -
Facebook Chat Updater
</title>
<!-- = current_page.data.title || (defined?(project) && project.name) -->
<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
<link href="/stylesheets/all.css" rel="stylesheet" type="text/css" />
<link href='/favicon.png' rel='icon' type='image/x-icon'>
</head>
<body class='x2011 x2011_02 x2011_02_01 x2011_02_01_facebook-chat-updater x2011_02_01_facebook-chat-updater_index'>
<div class='container'>
<header class='header'>
<h1 class='author'>
<a href='/'>Zequez</a>
</h1>
<p class='slogan'>Just a place to write about the stuff I make, do, think, and maybe eat</p>
</header>
<nav class='sidebar' id='sidebar'>
<div class='sidebar-overlay' id='sidebar-overlay'></div>
<div class='sidebar-button' id='sidebar-button'></div>
<section class='sidebar-section'>
<h1>
<a href='/projects'>Projects</a>
</h1>
<ul class='projects-list'>
<li>
<a href='/projects/zequez-blog'>
Zequez blog (this website)
<small>(mid-2015)</small>
</a>
</li>
<li>
<a href='/projects/prismata-subreddit-extension'>
Prismata Subreddit Extension
<small>(late-2014)</small>
</a>
</li>
<li>
<a href='/projects/playtime-for-the-buck'>
Playtime For The Buck
<small>(mid-2014)</small>
</a>
</li>
<li>
<a href='/projects/mapa-de-transporte'>
Mapa de Transporte
<small>(mid-2012)</small>
</a>
</li>
<li>
<a href='/projects/comicsen'>
Comicsen
<small>(late-2011)</small>
</a>
</li>
<li>
<a href='/projects/target-shooter'>
Target Shooter
<small>(early-2011)</small>
</a>
</li>
<li>
<a href='/projects/series-follower'>
Series Follower
<small>(early-2011)</small>
</a>
</li>
<li>
<a href='/projects/qembole'>
Qembole!
<small>(2009-2010)</small>
</a>
</li>
</ul>
<h1>
<a href='/'>Latest posts</a>
</h1>
<ul class='latest-articles-list'>
<li>
<a href='/2014/06/07/tired-of-cmd-c-not-stopping-the-process/'>
Tired of Cmd+C not stopping the process?
<small> 7 June 2014</small>
</a>
</li>
<li>
<a href='/2014/06/01/beware-inner-html-ie/'>
Beware of using innerHTML to remove all elements from a parent if you intend to reuse the elements later
<small> 1 June 2014</small>
</a>
</li>
<li>
<a href='/2014/04/08/deploying-jekyll-with-plugins-to-github/'>
Deploying Jekyll with plugins to Github pages: the easy way
<small> 8 April 2014</small>
</a>
</li>
<li>
<a href='/2014/04/05/autoplay-not-working-on-one-device/'>
Autoplay not working on one device on Windows
<small> 5 April 2014</small>
</a>
</li>
<li>
<a href='/2014/03/30/hello-world/'>
Hellow world! Now in anglo!
<small>30 March 2014</small>
</a>
</li>
</ul>
<h1>
<a href='/about-me'>About me / Contact</a>
</h1>
<!-- - data.sidebar.items.each do |item| -->
<!-- %h1 -->
<!-- - if item.url -->
<!-- %a{href: item.url} -->
<!-- = item.name -->
<!-- - else -->
<!-- = item.name -->
<!-- - if item.items -->
<!-- %ul -->
<!-- - item.items.each do |subitem| -->
<!-- %li -->
<!-- %a{href: subitem.url}= subitem.name -->
</section>
</nav>
<main class='main'>
<article>
<h1>
Facebook Chat Updater
<small>-  1 Feb 2011</small>
</h1>
<p><a title="Facebook chat" href="/uploads/2011/02/facebook-chat-new.jpg">right-medium-top</a></p>

<p>¿Cansados de querer hablarle a una persona por el chat de Facebook y que en el mismísimo momento en que le están por escribir se desconecta? Bueno, yo sí.</p>

<p>Esto sucede porque Facebook actualiza la lista personas conectadas en el chat de manera poco frecuente, y siempre que vas a comenzar a hablarle a una persona.</p>

<p>Tras una tarde de ingeniería inversa en el debugger de Chrome logré descifrar de manera precaria como es que funciona el cliente de Facebook y di con la forma de actualizar la lista de amigos manualmente:</p>
<pre class="highlight javascript"><code>  <span class="nx">Arbiter</span><span class="p">.</span><span class="nx">_instance</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="s2">"buddylist/initialized"</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="nx">_forceUpdate</span><span class="p">();</span>
</code></pre>

<p>Si pegan el código en la barra de navegación con un &ldquo;javascript:&rdquo; detrás de este podrán ver como se actualiza la lista, y si tienen la consola abierta también verá como es que hace un llamado a la dirección &ldquo;http://www.facebook.com/ajax/chat/buddy<em>list.php?</em>_a=1&rdquo; mediante AJAX.</p>

<p>Claro, podrían pegar el código con un setInterval cada vez que entran a Facebook&hellip; pero sería muy engorroso. Por esta razón decidí escribir una extensión para Google Chrome -la primera extensión que he hecho- que actualiza la lista de amigos conectados cada 3 segundos una vez que carga la página&hellip;</p>

<p><a title="Descargar extensión Facebook Chat Updater para Google Chrome" href="http://dl.dropbox.com/u/3682061/blog/zequez/facebookChatUpdater.crx">Descargar extensión Facebook Chat Updater para Google Chrome</a></p>

<p>Siéntanse libres de hacer una extensión para su navegador web favorito usando <code>Arbiter._instance._events[&quot;buddylist/initialized&quot;][0]._forceUpdate();</code></p>

<div class='article-tags'>
<strong>Tags:</strong>
<a href="/tag/javascript">javascript</a>
<a href="/tag/scripts">scripts</a>
<a href="/tag/extensions">extensions</a>
<a href="/tag/facebook">facebook</a>
</div>
</article>

</main>
<footer class='footer'>
<a href='/about-me'>
Zequez
</a>
&copy; 2015
</footer>
</div>
<script src="/javascripts/all.js" type="text/javascript"></script>
<!-- %aside -->
<!-- %h2 Recent Articles -->
<!-- %ol -->
<!-- - blog.articles[0...10].each do |article| -->
<!-- %li -->
<!-- = link_to article.title, article -->
<!-- %span= article.date.strftime('%b %e') -->
<!-- %h2 Tags -->
<!-- %ol -->
<!-- - blog.tags.each do |tag, articles| -->
<!-- %li= link_to "#{tag} (#{articles.size})", tag_path(tag) -->
<!-- %h2 By Year -->
<!-- %ol -->
<!-- - blog.articles.group_by {|a| a.date.year }.each do |year, articles| -->
<!-- %li= link_to "#{year} (#{articles.size})", blog_year_path(year) -->
</body>
</html>
